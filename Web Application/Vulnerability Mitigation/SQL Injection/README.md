# Overview

This page contains recommendations for the implementation of protection against SQL injection (SQLi) attacks.

# General

<div align="left">
<img src="/.gitbook/assets/type-base-icon.svg">
</div>

- Do **not** use string formatting or concatenation to assemble SQL queries.
- Use prepared statements (or parametrized queries) to assemble SQL queries.

# Prepared statements

<div align="left">
<img src="/.gitbook/assets/type-base-icon.svg">
</div>

{% tabs %}
{% tab title="Go" %}

Use a database driver from the following list of available drivers: [https://github.com/golang/go/wiki/SQLDrivers](https://github.com/golang/go/wiki/SQLDrivers).

**Example for PostgreSQL**

```go
func handler(w http.ResponseWriter, r *http.Request) {
    userId := r.URL.Query().Get("id")
    if userId != "" {
        rows, err := db.Query("SELECT name FROM users WHERE id = $1", userId)
        // ...
    }
}
```

Remember that placeholders are database specific:

**MySQL**

Placeholder

```sql
WHERE col = ?
```

Example

```go
db.Query("SELECT name FROM users WHERE favorite_fruit = ? OR age BETWEEN ? AND ?", "orange", 64, 67)
```

**PostgreSQL**

Placeholder

```sql
WHERE col = $1
```

Example

```go
db.Query("SELECT name FROM users WHERE favorite_fruit = $1 OR age BETWEEN $2 AND $3", "orange", 64, 67)
```

**Oracle**

Placeholder

```sql
WHERE col = :col
```

Example

```go
stmt, err := conn.Prepare("SELECT name FROM users WHERE favorite_fruit = :1 OR age BETWEEN :2 AND :3")
rows, err := stmt.Query("orange", 64, 67)
```
{% endtab %}
{% endtabs %}

# References

- [OWASP Cheat Sheet Series: SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)

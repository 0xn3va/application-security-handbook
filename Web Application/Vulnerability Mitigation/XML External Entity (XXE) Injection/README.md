# Overview

This page contains recommendations for the implementation of protection against XML External Entity (XXE) injection attacks.

# General

<div align="left">
<img src="/.gitbook/assets/type-base-icon.svg">
</div>

- Disable DTDs (external entities) completely.
- If it is not possible to disable DTDs (external entities) completely, disable external entities and external document type declarations.
- Use up-to-date XML parsers that are actively maintained by a community or its authors.

# Disabling DTDs (external entities)

Disabling DTDs (external entities) depends on the XML parser being used. You can find prevention guidance for many languages and commonly used XML parsers in those languages at the following link [OWASP Cheat Sheet Series: XML External Entity Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html).

{% tabs %}
{% tab title="Go" %}

Use the [encoding/xml](https://pkg.go.dev/encoding/xml) package to work with XML in Go. Go's XML decoder does not process XML DTDs (external entities), therefore, it is protected against XXE by default.

```go
import (
    "encoding/xml"
)

func handler(w http.ResponseWriter, r *http.Request) {
    decoder := xml.NewDecoder(r.Body)
    for {
        token, err := decoder.Token()
    // ...
    }
}
```
{% endtab %}
{% endtabs %}

# References

- [OWASP Cheat Sheet Series: XML External Entity Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)
